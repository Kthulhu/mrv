#!/bin/bash
# tmrvUI /path/to/maya/binary [ maya_args ]
# 
# Uses standard unittest testrunner to run UI tests in mayarv.test.maya.ui
base=$(cd ${0%/*} && echo $PWD)
if [[ $base != /* ]]; then
	base=$PWD/$base
fi

if [ $# = 0 ]; then 
	echo "runtestUI /path/to/maya/binary [nose arguments]" && exit 2
fi

# prepare the environment to use a minimal UI - put mayarv into the script path
# as well as our helper script
MAYA_SCRIPT_PATH=$MAYA_SCRIPT_PATH:$base:$(cd $base/../../..; echo $PWD)
MRV_PYTHON_PATH=$(cd $base/../../..; echo $PWD)
MAYA_OVERRIDE_UI=initialLayout_minimal.mel

export MAYA_SCRIPT_PATH MAYA_OVERRIDE_UI MRV_PYTHON_PATH

# assure we have no additional environment set
MAYA_APP_DIR=/tmp/maya_test_home
mkdir -p $MAYA_APP_DIR
export MAYA_APP_DIR
touch $MAYA_APP_DIR/Maya.env

# first arg must be the path to the maya binary to start
# Everything else will be passed to nose
mayapath=$1
shift
export NOSE_ARGS=$@

# Make sure commands passed to maya are not split up again, hence 
# we set the split characters to be empty
IFS=
set -f

# start maya and make sure it will execute the python user interface tests
# for this to work, maya must be in the path
$mayapath
